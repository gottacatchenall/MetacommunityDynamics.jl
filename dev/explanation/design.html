<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The design of MetacommunityDynamics.jl | MetacommunityDynamics.jl</title>
    <meta name="description" content="Documentation for MetacommunityDynamics.jl">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/MetacommunityDynamics.jl/dev/assets/style.CoFNaS2v.css" as="style">
    <link rel="preload stylesheet" href="/MetacommunityDynamics.jl/dev/vp-icons.css" as="style">
    
    <script type="module" src="/MetacommunityDynamics.jl/dev/assets/app.BPUtag0H.js"></script>
    <link rel="preload" href="/MetacommunityDynamics.jl/dev/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/MetacommunityDynamics.jl/dev/assets/chunks/theme.-MqvAHyz.js">
    <link rel="modulepreload" href="/MetacommunityDynamics.jl/dev/assets/chunks/framework.Ce1246Qc.js">
    <link rel="modulepreload" href="/MetacommunityDynamics.jl/dev/assets/explanation_design.md.C4xwcLLv.lean.js">
    <script src="/MetacommunityDynamics.jl/versions.js"></script>
    <script src="/MetacommunityDynamics.jl/dev/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle" data-v-822684d1 data-v-0f4f798b><a class="title" href="/MetacommunityDynamics.jl/dev/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/MetacommunityDynamics.jl/dev/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>MetacommunityDynamics.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/gottacatchenall/MetacommunityDynamics.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/gottacatchenall/MetacommunityDynamics.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _MetacommunityDynamics_jl_dev_explanation_design" data-v-83890dd9><div><h1 id="The-design-of-MetacommunityDynamics.jl" tabindex="-1">The design of <code>MetacommunityDynamics.jl</code> <a class="header-anchor" href="#The-design-of-MetacommunityDynamics.jl" aria-label="Permalink to &quot;The design of `MetacommunityDynamics.jl` {#The-design-of-MetacommunityDynamics.jl}&quot;">​</a></h1><p>This document is for advanced users interested in contributing new models or building complicated custom models in <code>MetacommunityDynamics.jl</code>.</p><h2 id="The-type-system" tabindex="-1">The type system <a class="header-anchor" href="#The-type-system" aria-label="Permalink to &quot;The type system {#The-type-system}&quot;">​</a></h2><p>While MetacommunityDynamics enables simulation of dynamics in a single place (<em>locally</em>), its main goal is to enable reaction-diffusion models on spatial graphs. Similarly, although MetacommunityDynamics is perfectly adaquete for simulating the dynamics of single-species systems, the <em>core design goals</em> are motivated by an interest in simulating communities on spatial graphs, where environmental variation across each patch/node in the graph influences the dynamics at that node/patch, with a particular emphasis on understanding how different parameterizations of models causes regime shifts in resulting species compositions across space, across different levels of neutral, niche, and dispersal proccesses.</p><p>What are the essential things you need to build a simulation model that meets this criteria?</p><ol><li><p>We need a way to represent different types of <em>models</em> (e.g. Lotka-Volterra, Rosenzweig-MacArthur, etc).</p></li><li><p>A <em>spatial graph</em>, consisting of a set of nodes/patches connected by dispersal, that also can represent environmental information associated with each patch.</p></li><li><p>A <em>species pool</em> with <em>traits</em>, which are an arbitrary set of named values that correspond to each species in the species pool.</p></li><li><p>The <em>niche</em>, where the combination of the local (named!) environmental conditions at a patch and other species present shifts the parameters of the dynamics at that patch.</p></li><li><p>A model of <em>diffusion</em>. We take a dispersal kernel and normalize its value across each (source-&gt;target) pair of patches to create a <em>dispersal potential</em>, which is a distribution for each (source-&gt;target pair).</p></li></ol><p>Note that all are interconnected and must interface with one another to achieve our overall goal:</p><ul><li><p>the model&#39;s parameters must match species pool size and number of spatial sites (1-&gt;2, 1-&gt;3)</p></li><li><p>the spatial graph must provide environmental data for the niche (2 -&gt; 4)</p></li><li><p>the species pool must provide traits for the niche (3-&gt;4)</p></li><li><p>the niche must provide parameters for the spatial version of the model based on the species pool and (spatial graph w/ environment) (2-&gt;1, 4-&gt;1)</p></li><li><p>both the species and environment must provide named parameters to the niche (2-&gt;4,3-&gt;4)</p></li></ul><h3 id="models" tabindex="-1">Models <a class="header-anchor" href="#models" aria-label="Permalink to &quot;Models&quot;">​</a></h3><p>The first element of the type system is distinguishing different properties of different <code>Model</code>s. In EcoDynamics.jl, <code>Model</code> is the abstract type under which all concrete model definitions are subtyped. Specifically, <code>Model</code> is defined as a <em>parameteric</em> abstract type where stores information about the important meta-properties about models.</p><p><code>abstract type Model{SC&lt;:Scale,M&lt;:Measurement,SP&lt;:Spatialness,D&lt;:Discreteness} end</code></p><p>Specifically there are four different important properties which <code>Model</code> stores (in Julia development, this design pattern is called using &#39;traits&#39;, although we refrain from using that terminology in this documentation to avoid confusion with <code>Trait</code>s as the type of information that describes properties about species).</p><p>These four properties are <code>Scale</code>, <code>Measurement</code>, <code>Spatialness</code>, and <code>Discreteness</code>. Each of these are defined as abstract types, and the different values they can take on are defined as abstract types that are subtypes of the category they correspond to.</p><ol><li><p><code>Scale</code> refers to the organizational scale a model is <em>originally</em> designed, with the options being <code>Population</code>, <code>Community</code>, <code>Metapopulation</code>, and <code>Metacommunity</code>. Note that a model being at the <code>Population</code> or <code>Community</code> scale doesn&#39;t preclude it from being turned into reaction-diffusion models on spatial graphs, however <code>Metapopulation</code> and <code>Metacommunity</code> models are such that they have no corresponding local version (think Hanksi&#39;s metapopulation model).</p></li><li><p><code>Measurement</code> refers to the type of information that is changing over time in a given model. There options here are (1) <code>Occupancy</code>, which indicates binary presence/absence state, (2) <code>Abundance</code>, where each state is a non-negative integer representing the count of individuals and (3) <code>Biomass</code>, where each state is a non-negative real number indicating some relative measure of biomass.</p></li><li><p><code>Discreteness</code> refers to whether a model is defined in <code>Continuous</code> or <code>Discrete</code> time.</p></li><li><p><code>Spatialness</code> refers to whether a constructed model is only occuring at a single location (<code>Local</code>), or whether the model is constructed across a spatial graph (<code>Spatial</code>). This type-parameter is distinct because it can change. The method <code>spatialize</code> transforms a <code>Local</code> model into spatial models.</p></li></ol><h3 id="Spatial-graphs" tabindex="-1">Spatial graphs <a class="header-anchor" href="#Spatial-graphs" aria-label="Permalink to &quot;Spatial graphs {#Spatial-graphs}&quot;">​</a></h3><p>The <code>SpatialGraph</code> type contains information about the coordinates of each patch/node, as well as environmental covariates at each site. Environmental covariates are stored in a dictionary where the key is the name of the variable, and the value is a vector of values corresponds to each node in the spatial graph.</p><h3 id="Species-Pool" tabindex="-1">Species Pool <a class="header-anchor" href="#Species-Pool" aria-label="Permalink to &quot;Species Pool {#Species-Pool}&quot;">​</a></h3><p>The <code>SpeciesPool</code> type contains a list of species names (as <code>String</code>s or <code>Symbol</code>s), and more importantly a dictionary of named trait values. The trait values are important as they are one of two inputs to a <code>Niche</code>, which enables variation in model parameters across space as a function of enviornmental conditions.</p><h3 id="niches" tabindex="-1">Niches <a class="header-anchor" href="#niches" aria-label="Permalink to &quot;Niches&quot;">​</a></h3><ul><li><p>Provide a default niche function for each model, but enable it to be written custom. This enables environment-contigent interaction strengths, etc.</p></li><li><p>Generally, the default niche will modify the growth rates in a model by a a function of the distance between a single dimensional environmental variable and a species trait, e.g. adjusting <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.375ex;" xmlns="http://www.w3.org/2000/svg" width="2.705ex" height="1.92ex" role="img" focusable="false" viewBox="0 -683 1195.6 848.6" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3;"></path></g><g data-mml-node="mn" transform="translate(792,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3;"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;width:auto;overflow:hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mn>0</mn></msub></math></mjx-assistive-mml></mjx-container> in the SIR model</p></li></ul><h2 id="Dispatch-patterns" tabindex="-1">Dispatch patterns <a class="header-anchor" href="#Dispatch-patterns" aria-label="Permalink to &quot;Dispatch patterns {#Dispatch-patterns}&quot;">​</a></h2><ul><li><p>What is the lifespan of building and running a model?</p></li><li><p>Maybe there is a figure for the paper here, flowchart of what is the next method you run based on what you are trying to do?</p></li></ul><h2 id="QA-Methods-for-Included-Models" tabindex="-1">QA Methods for Included Models <a class="header-anchor" href="#QA-Methods-for-Included-Models" aria-label="Permalink to &quot;QA Methods for Included Models {#QA-Methods-for-Included-Models}&quot;">​</a></h2><p>One main design goal of <code>MetacommunityDynamics.jl</code> is to ensure it is as easy as possible to write customs models. &quot;Easy&quot;, in this sense, means both involving writing the fewest lines of code possible, and not requiring a deep understanding of Julia or its type system.</p><p>This means that the instructions on how to add custom models (see TBD docs section) doesn&#39;t include some of the extra methods added to included models to avoid possible mistakes. e.g.:</p><ul><li><p>Warnings about parameter values that are extreme or nonsensical (providing an intrinsic growth rate to a predator in a LV model, say)</p></li><li><p>Warnings about whether a niche function leads toward &quot;crucial&quot; parameters going to 0/unreasonable values at most sites depending on the range of environmnetal variables provided in the SpatialGraph</p></li></ul></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/gottacatchenall/MetacommunityDynamics.jl/edit/main/docs/src/explanation/design.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"bibliography.md\":\"D_JwqxAg\",\"explanation_design.md\":\"C4xwcLLv\",\"how_to_custom_functional_response.md\":\"DD1hWu_d\",\"how_to_metapopulation_inference.md\":\"DYiUoLCL\",\"how_to_metapopulation_synchrony.md\":\"BYz6XFyD\",\"how_to_neutral_to_niche.md\":\"CKvvpj_B\",\"index.md\":\"Zw_ROzj_\",\"reference_internal.md\":\"CVzpg6NR\",\"reference_model_index_community_overview.md\":\"CA_L22Hj\",\"reference_model_index_metacommunity_overview.md\":\"DSnZyv1-\",\"reference_model_index_metapopulation_overview.md\":\"Bx--kZ9m\",\"reference_model_index_population_overview.md\":\"ZMAjWzPg\",\"reference_public.md\":\"DE3gGoO9\",\"reference_spatialgraphs.md\":\"MmhXbbNr\",\"tutorials_01_getting_started.md\":\"DGOkATPE\",\"tutorials_02_consumer_resource.md\":\"DyY-i4ZQ\",\"tutorials_03_environmental_variation.md\":\"Y91uhZeE\",\"tutorials_04_occupancy_modeling.md\":\"DiRctexb\",\"tutorials_quick_start.md\":\"fhRQ-CYW\",\"tutorials_tutorials.md\":\"Bw_abwHG\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"MetacommunityDynamics.jl\",\"description\":\"Documentation for MetacommunityDynamics.jl\",\"base\":\"/MetacommunityDynamics.jl/dev/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"component\":\"VersionPicker\"}],\"sidebar\":[],\"editLink\":{\"pattern\":\"https://https://github.com/gottacatchenall/MetacommunityDynamics.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/gottacatchenall/MetacommunityDynamics.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>